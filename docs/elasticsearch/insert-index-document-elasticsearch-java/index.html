<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
  
  <title>Insert, Index document in Elasticsearch using Java</title>
  <meta property="og:title" content="Insert, Index document in Elasticsearch using Java" />
  <meta name="twitter:title" content="Insert, Index document in Elasticsearch using Java" />
  

  

  <meta name="author" content=""/>
  <meta property="og:site_name" content="Programming Notes" />
  <meta property="og:url" content="https://sureshsarda.github.io/elasticsearch/insert-index-document-elasticsearch-java/" />

  
  <meta name="twitter:card" content="summary" />

  

  
  <meta property="og:type" content="article" />
  
  
  
  <meta name="generator" content="Hugo 0.80.0" />
  
  

  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@100;300;500;700;900&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:wght@300&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Oxygen&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro:wght@600&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">


  <link rel="stylesheet" href="https://sureshsarda.github.io/assets/css/style.css" />
  <link rel="stylesheet" href="https://sureshsarda.github.io/assets/css/custom.css" />
  
  
  
  <script type="text/javascript" src="https://sureshsarda.github.io/assets/js/bundle.js"></script>
</head>




<body>
    <article class="container">
        <header>
            

            
                <p>
                    <a href="/">Programming Notes</a>
                </p>
                <h1>Insert, Index document in Elasticsearch using Java</h1>
                
                <a href="https://sureshsarda.github.io/tags/Elasticsearch" class="c-tag">Elasticsearch</a>
                
                <a href="https://sureshsarda.github.io/tags/Java" class="c-tag">Java</a>
                
            
            
        </header>





        <main id="js-article" class="container">
            <div class="row">

                <div class="col-9 py-5">
                    <p>In this article we will see how to insert a document in Elasticsearch using the High Level Client provided by Elasticsearch.</p>
<h2 id="prepare-the-index-request">Prepare the Index Request</h2>
<p>Elasticsearch client accepts <code>IndexRequest</code> to insert documents. Two required details for this request are:</p>
<ol>
<li>Name of the index</li>
<li>Document source</li>
</ol>
<p>Everything else can take default value. We will stick to the easy path to create our very first document and explore other optional arguments later.</p>
<p>There are multiple ways to provide the source of the document - using a map, using JSON string, using <code>XContent</code>, etc.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">String body <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;{&#39;name&#39;: &#39;John Doe&#39;, &#39;age&#39;: 25, updated: &#39;2019-11-25&#39;}&#34;</span><span style="color:#f92672">;</span>
IndexRequest request <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> IndexRequest<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;users&#34;</span><span style="color:#f92672">);</span>
request<span style="color:#f92672">.</span><span style="color:#a6e22e">source</span><span style="color:#f92672">(</span>body<span style="color:#f92672">,</span> XContentType<span style="color:#f92672">.</span><span style="color:#a6e22e">JSON</span><span style="color:#f92672">);</span>
</code></pre></div><p>The request is ready to be inserted into Elasticsearch.</p>
<h2 id="insert-the-document">Insert the document</h2>
<p>Assuming you have the [connection established]({% post_url elasticsearch/2019-11-25-connecting-to-elasticsearch-from-java %}) you can just call the <code>index</code> method on the client.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">client<span style="color:#f92672">.</span><span style="color:#a6e22e">index</span><span style="color:#f92672">(</span>request<span style="color:#f92672">,</span> RequestOptions<span style="color:#f92672">.</span><span style="color:#a6e22e">DEFAULT</span><span style="color:#f92672">);</span>
</code></pre></div><p>Connection can be setup like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"> RestHighLevelClient client <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> RestHighLevelClient<span style="color:#f92672">(</span>
    RestClient<span style="color:#f92672">.</span><span style="color:#a6e22e">builder</span><span style="color:#f92672">(</span>
        <span style="color:#66d9ef">new</span> HttpHost<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;localhost&#34;</span><span style="color:#f92672">,</span> 9200<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;http&#34;</span><span style="color:#f92672">)));</span>
</code></pre></div><p>make sure you close the connection by calling <code>client.close()</code> once you are done using it.</p>
<h2 id="check-if-it-was-inserted">Check if it was inserted</h2>
<p>We will see in next articles how to retrieve documents from Elasticsearch. To quicky check if the document was inserted, we can run:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">curl localhost:9200/users/_search?pretty
</code></pre></div><p>And this should give us the response with the document:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
  <span style="color:#f92672">&#34;took&#34;</span> : <span style="color:#ae81ff">24</span>,
  <span style="color:#f92672">&#34;timed_out&#34;</span> : <span style="color:#66d9ef">false</span>,
  <span style="color:#f92672">&#34;_shards&#34;</span> : {
    <span style="color:#f92672">&#34;total&#34;</span> : <span style="color:#ae81ff">1</span>,
    <span style="color:#f92672">&#34;successful&#34;</span> : <span style="color:#ae81ff">1</span>,
    <span style="color:#f92672">&#34;skipped&#34;</span> : <span style="color:#ae81ff">0</span>,
    <span style="color:#f92672">&#34;failed&#34;</span> : <span style="color:#ae81ff">0</span>
  },
  <span style="color:#f92672">&#34;hits&#34;</span> : {
    <span style="color:#f92672">&#34;total&#34;</span> : {
      <span style="color:#f92672">&#34;value&#34;</span> : <span style="color:#ae81ff">2</span>,
      <span style="color:#f92672">&#34;relation&#34;</span> : <span style="color:#e6db74">&#34;eq&#34;</span>
    },
    <span style="color:#f92672">&#34;max_score&#34;</span> : <span style="color:#ae81ff">1.0</span>,
    <span style="color:#f92672">&#34;hits&#34;</span> : [
      {
        <span style="color:#f92672">&#34;_index&#34;</span> : <span style="color:#e6db74">&#34;users&#34;</span>,
        <span style="color:#f92672">&#34;_type&#34;</span> : <span style="color:#e6db74">&#34;_doc&#34;</span>,
        <span style="color:#f92672">&#34;_id&#34;</span> : <span style="color:#e6db74">&#34;ZAoIz24BnE_7WJlL7MOP&#34;</span>,
        <span style="color:#f92672">&#34;_score&#34;</span> : <span style="color:#ae81ff">1.0</span>,
        <span style="color:#f92672">&#34;_source&#34;</span> : {
          <span style="color:#f92672">&#34;name&#34;</span> : <span style="color:#e6db74">&#34;John Doe&#34;</span>,
          <span style="color:#f92672">&#34;updated&#34;</span> : <span style="color:#e6db74">&#34;2019-12-04T03:51:38.797Z&#34;</span>,
          <span style="color:#f92672">&#34;age&#34;</span> : <span style="color:#ae81ff">25</span>
        }
      }
    ]
  }
}

</code></pre></div><h2 id="alternatives-to-create-a-document">Alternatives to create a document</h2>
<h3 id="inserting-document-from-a-map">Inserting document from a Map</h3>
<p>Many times we might have a Map serialized from some channel to be indexed in Elasticsearch. Elasticsearch provides helper method to insert a Map directly. This can be achieved like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">IndexRequest request <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> IndexRequest<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;users&#34;</span><span style="color:#f92672">);</span>
Map<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">,</span> Object<span style="color:#f92672">&gt;</span> data <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> HashMap<span style="color:#f92672">&lt;&gt;();</span>
data<span style="color:#f92672">.</span><span style="color:#a6e22e">put</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;John Doe&#34;</span><span style="color:#f92672">);</span>
data<span style="color:#f92672">.</span><span style="color:#a6e22e">put</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;age&#34;</span><span style="color:#f92672">,</span> 25<span style="color:#f92672">);</span>
data<span style="color:#f92672">.</span><span style="color:#a6e22e">put</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;updated&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">new</span> Date<span style="color:#f92672">());</span>
request<span style="color:#f92672">.</span><span style="color:#a6e22e">source</span><span style="color:#f92672">(</span>data<span style="color:#f92672">);</span>
</code></pre></div><h3 id="inserting-document-directly-using-key-values">Inserting document directly using key values</h3>
<p>Data can be directly entered in the request using key value in the source object like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">IndexRequest request <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> IndexRequest<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;users&#34;</span><span style="color:#f92672">);</span>
request<span style="color:#f92672">.</span><span style="color:#a6e22e">source</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;John Doe&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;age&#34;</span><span style="color:#f92672">,</span> 25<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;updated&#34;</span><span style="color:#f92672">,</span> <span style="color:#66d9ef">new</span> Date<span style="color:#f92672">());</span>
</code></pre></div><h2 id="conclusion">Conclusion</h2>
<p>We saw how to insert a document in Elasticsearch using the Java client. Documents need the index name and the content. Documents can be created directly from JSON strings, Map or directly from key value pairs in the <code>source</code> method of the <code>IndexRequest</code>.</p>


                </div>
                <aside class="bd-toc toc col-2 py-5">
                    <div class="sticky-top pt-5">
                        <h3>On this page</h3>
                        <nav id="TableOfContents">
  <ul>
    <li><a href="#prepare-the-index-request">Prepare the Index Request</a></li>
    <li><a href="#insert-the-document">Insert the document</a></li>
    <li><a href="#check-if-it-was-inserted">Check if it was inserted</a></li>
    <li><a href="#alternatives-to-create-a-document">Alternatives to create a document</a>
      <ul>
        <li><a href="#inserting-document-from-a-map">Inserting document from a Map</a></li>
        <li><a href="#inserting-document-directly-using-key-values">Inserting document directly using key values</a></li>
      </ul>
    </li>
    <li><a href="#conclusion">Conclusion</a></li>
  </ul>
</nav>
                    </div>
                </aside>
            </div>

            

<section class="p-related">
  <h3>Related Content</h3>
  <ul>
    
    <li>
      <a href="/elasticsearch/search-match-all-from-java-using-high-level-client/">
        <span>Search Elasticsearch from Java using High Level Client</span>
      </a>
    </li>
    
    <li>
      <a href="/elasticsearch/connect-from-java-using-high-level-client/">
        <span>Connect to Elasticsearch using Java High Level Client</span>
      </a>
    </li>
    
    <li>
      <a href="/java/creating-csv-from-strings/">
        <span>Creating CSV from Strings in Java</span>
      </a>
    </li>
    
    <li>
      <a href="/posts/2017-07-02-vagrant-setting-up-and-tearing-down-development-environments-on-the-fly/">
        <span>Vagrant - Setting up and tearing down development environments on the fly</span>
      </a>
    </li>
    
  </ul>
</section>


        </main>

        
    </article>
    <footer class="mt-5 py-5">
    <div class="container py-5">
        
        <div class="row">
            <div class="col-lg-4 mb-3">
                <h3>
                    <a href="/">Programming Notes</a>
                </h3>
                <ul class="list-unstyled">
                    <li>Share the knowledge that you can and learn more in the process.</li>
                </ul>

            </div>
            <div class="col-lg-1"></div>
            
            
            <div class="col-lg-2">
                <h5>Curated</h5>
                <ul class="list-unstyled">
                    
                    <li class="mb-2"><a href="/blog">Blog</a></li>
                    
                    <li class="mb-2"><a href="/books">Books</a></li>
                    
                    <li class="mb-2"><a href="/papers">Papers</a></li>
                    
                </ul>
            </div>
            
            
            
            <div class="col-lg-2">
                <h5>Links</h5>
                <ul class="list-unstyled">
                    
                    <li class="mb-2"><a href="/series">Article Series</a></li>
                    
                    <li class="mb-2"><a href="/categories">Categories</a></li>
                    
                    <li class="mb-2"><a href="/posts">Posts</a></li>
                    
                    <li class="mb-2"><a href="/tags">Tags</a></li>
                    
                </ul>
            </div>
            
            
            
            <div class="col-lg-2">
                <h5>Social</h5>
                <ul class="list-unstyled">
                    
                    <li class="mb-2"><a href="/">Github</a></li>
                    
                    <li class="mb-2"><a href="/">LinkedIn</a></li>
                    
                    <li class="mb-2"><a href="/">Medium</a></li>
                    
                    <li class="mb-2"><a href="/">Stack Overflow</a></li>
                    
                    <li class="mb-2"><a href="/">Twitter</a></li>
                    
                </ul>
            </div>
            
            
        </div>
        
    </div>

    <div class="p-copyright">
        
        Suresh Sarda
        &nbsp;&bull;&nbsp;
        2020

        
        &nbsp;&bull;&nbsp;
        <a href="https://sureshsarda.github.io/">Programming Notes</a>
        
        
    </div>
</footer>